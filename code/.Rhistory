res = read.table(files_to_viz[[i]],header = T, sep = " ", skip = 0)
if(unique(res$cenario) == "Cenario_9"){
res  = res %>% mutate(tecnica = "brt") %>% rename(yobs = truth, ypred = response)
res = res %>% select(-c(iter,set,id))
res = res %>% mutate(range_datas = range_cen9, data = data_cen9, hora = hora_cen9,
concat_coord = concat_cen9)
res = res[,c("tecnica","cenario","range_datas","concat_coord","data",
"hora","target","hmlook_back","yobs","ypred")]
write.table(res, file = files_to_viz[[i]] )
}
}
files_to_viz = list.files("../../results/", pattern = "ypred", recursive = T, full.names = T)
res =list()
for(i in 1:length(files_to_viz)){
res[[i]] = read.table(files_to_viz[[i]],header = T, sep = " ", skip = 0)
}
results = do.call(res,bind_rows)
results = do.call(bind_rows, res)
warnings()
res[[1]]
str(res[[1]])
files_to_viz = list.files("../../results/", pattern = "ypred", recursive = T, full.names = T)
res =list()
for(i in 1:length(files_to_viz)){
res[[i]] = read.table(files_to_viz[[i]],header = T, sep = " ", skip = 0) %>%
mutate_if(is.factor, as.character)
}
results = do.call(bind_rows, res)
head(results)
dim(results)
files_to_viz = list.files("../../results/", pattern = "ypred", recursive = T, full.names = T)
res =list()
for(i in 1:length(files_to_viz)){
res[[i]] = read.table(files_to_viz[[i]],header = T, sep = " ", skip = 0) %>%
mutate_if(is.factor, as.character)
}
results = do.call(bind_rows, res) %>% mutate(erro = ypred - yobs)
head(results)
# Plotting MAE progress over Scenarios -----------------------------------
res1 = results %>% group_by(tecnica,target,cenario, hmlook_back) %>% summarise(mae = mean(abs(erro)))
head(res)
head(res1)
dim(res1)
res1 %>% filter(target == "temp") %>%
ggplot(aes(x = hmlook_back, y = mae, col = cenario)) %>% geom_line()
res1 %>% filter(target == "temp") %>%
ggplot(aes(x = hmlook_back, y = mae, col = cenario)) + geom_line()
res1 = results %>% group_by(tecnica,target,cenario, hmlook_back) %>% summarise(mae = mean(abs(erro)))
res1 %>% filter(target == "temp") %>%
ggplot(aes(x = hmlook_back, y = mae, col = cenario)) + geom_line()
library(tidyverse)
rm(list = ls())
gc()
setwd("C:/Users/vinic/Google Drive/Mestrado/pratical_project/variability_part2/greenhouse_tseries/code")
files_to_viz = list.files("../../results/", pattern = "ypred", recursive = T, full.names = T)
res =list()
for(i in 1:length(files_to_viz)){
res[[i]] = read.table(files_to_viz[[i]],header = T, sep = " ", skip = 0) %>%
mutate_if(is.factor, as.character)
}
results = do.call(bind_rows, res) %>% mutate(erro = ypred - yobs)
# Plotting MAE progress over Scenarios -----------------------------------
res1 = results %>% group_by(tecnica,target,cenario, hmlook_back) %>% summarise(mae = mean(abs(erro)))
res1 %>% filter(target == "temp") %>%
ggplot(aes(x = hmlook_back, y = mae, col = cenario)) + geom_line()
res1 %>% filter(target == "temp")
res1 %>% filter(target == "temp") %>% as.data.frame()
res1 %>% filter(target == "temp") %>%
ggplot(aes(x = hmlook_back, y = mae, col = cenario)) + geom_line()+
facet_wrap(.~tecnica)
res1 %>% filter(target == "ur") %>%
ggplot(aes(x = hmlook_back, y = mae, col = cenario)) + geom_line()+
facet_wrap(.~tecnica)
files_tbmodel = list.files('../../data/',
full.names = T,
pattern = ".RData")
files_tbmodel
dat = get(load(files_tbmodel[[1]]))
head(dat)
apply(dat,2,unique)
apply(dat,2,length(unique))
apply(dat,2,function(x) length(unique(x)))
var_vet = apply(dat,2,function(x) length(unique(x)))
var_vet
var_vet > 1
var_vet[var_vet == 1]
dat = get(load(files_tbmodel[[2]]))
var_vet = apply(dat,2,function(x) length(unique(x)))
var_vet[var_vet == 1]
var_vet[var_vet == 2]
var_vet[var_vet <=5 ]
var_vet[var_vet <= 10 ]
dat = get(load(files_tbmodel[[3]]))
var_vet = apply(dat,2,function(x) length(unique(x)))
var_vet[var_vet <= 10 ]
var_vet[var_vet == 1]
var_vet[var_vet == 2]
var_vet[var_vet == 3]
var_vet[var_vet == 4]
dat = get(load(files_tbmodel[[4]]))
var_vet = apply(dat,2,function(x) length(unique(x)))
dat = get(load(files_tbmodel[[4]]))
var_vet = apply(dat,2,function(x) length(unique(x)))
var_vet[var_vet == 1]
var_vet[var_vet == 2]
var_vet[var_vet == 3]
var_vet[var_vet == 4]
var_vet[var_vet == 5]
var_vet[var_vet == 6]
var_vet[var_vet == 7]
var_vet[var_vet == 8]
var_vet[var_vet == 9]
var_vet[var_vet == 10]
head(dat)
files_tbmodel = list.files('../../data/',
full.names = T,
pattern = ".RData")
dat = get(load(files_tbmodel[[1]]))
head(dat)
unique(dat$data)[8:10]
ver = dat[test_lines,]
test_lines = which(dat$data %in% unique(dat$data)[8:10])
ver = dat[test_lines,]
head(ver)
colnames(ver)
concat_cen1 = ver$concat_coord
lenght(concat_cen1)
length(concat_cen1)
files_to_c = list.files("../../results/brt", pattern = "ypred", recursive = T, full.names = T)
i=1
res = read.table(files_to_viz[[i]],header = T, sep = " ", skip = 0)
head(res)
head(ver)
head(res)
head(ver["temp",])
head(ver[,"temp"])
head(res)
head(ver[,c("temp","data","hora")])
files_tbmodel = list.files('../../data/',
full.names = T,
pattern = ".RData")
dat = get(load(files_tbmodel[[1]]))
test_lines = which(dat$data %in% unique(dat$data)[8:10])
ver = dat[test_lines,] %>% arrange(data,hora)
concat_cen1 = ver$concat_coord
head(ver[,c("temp","data","hora")])
head(concat_cen1,10)
res$yobs == ver$temp
unique(res$yobs == ver$temp)
# getting all results in the same shape
files_to_c = list.files("../../results/", pattern = "ypred", recursive = T, full.names = T)
files_to_c
for(i in 1:length(files_to_c)){
res = read.table(files_to_viz[[i]],header = T, sep = " ", skip = 0)
if(unique(res$cenario) == "Cenario_1"){
res = res %>% mutate(concat_coord = concat_cen1)
write.table(res, file = files_to_viz[[i]] )
}
}
files_tbmodel = list.files('../../data/',
full.names = T,
pattern = ".RData")
dat = get(load(files_tbmodel[[1]]))
test_lines = which(dat$data %in% unique(dat$data)[8:10])
ver = dat[test_lines,] %>% arrange(data,hora)
concat_cen1 = ver$concat_coord
# getting all results in the same shape
files_to_c = list.files("../../results/", pattern = "ypred", recursive = T, full.names = T)
for(i in 1:length(files_to_c)){
res = read.table(files_to_c[[i]],header = T, sep = " ", skip = 0)
if(unique(res$cenario) == "Cenario_1"){
res = res %>% mutate(concat_coord = concat_cen1)
write.table(res, file = files_to_c[[i]] )
}
}
dat = get(load(files_tbmodel[[2]]))
test_lines = which(dat$data %in% unique(dat$data)[8:10])
ver = dat[test_lines,] %>% arrange(data,hora)
head(ver)
concat_cen5 = ver$concat_coord
files_to_c = list.files("../../results/", pattern = "ypred", recursive = T, full.names = T)
for(i in 1:length(files_to_c)){
res = read.table(files_to_c[[i]],header = T, sep = " ", skip = 0)
if(unique(res$cenario) == "Cenario_5"){
res = res %>% mutate(concat_coord = concat_cen1)
write.table(res, file = files_to_c[[i]] )
}
}
dat = get(load(files_tbmodel[[2]]))
test_lines = which(dat$data %in% unique(dat$data)[8:10])
ver = dat[test_lines,] %>% arrange(data,hora)
concat_cen5 = ver$concat_coord
files_to_c = list.files("../../results/", pattern = "ypred", recursive = T, full.names = T)
for(i in 1:length(files_to_c)){
res = read.table(files_to_c[[i]],header = T, sep = " ", skip = 0)
if(unique(res$cenario) == "Cenario_5"){
res = res %>% mutate(concat_coord = concat_cen5)
write.table(res, file = files_to_c[[i]] )
}
}
dat = get(load(files_tbmodel[[3]]))
test_lines = which(dat$data %in% unique(dat$data)[8:10])
ver = dat[test_lines,] %>% arrange(data,hora)
concat_cen7 = ver$concat_coord
files_to_c = list.files("../../results/", pattern = "ypred", recursive = T, full.names = T)
for(i in 1:length(files_to_c)){
res = read.table(files_to_c[[i]],header = T, sep = " ", skip = 0)
if(unique(res$cenario) == "Cenario_7"){
res = res %>% mutate(concat_coord = concat_cen7)
write.table(res, file = files_to_c[[i]] )
}
}
dat = get(load(files_tbmodel[[4]]))
test_lines = which(dat$data %in% unique(dat$data)[8:10])
ver = dat[test_lines,] %>% arrange(data,hora)
concat_cen9 = ver$concat_coord
head(ver)
files_to_c = list.files("../../results/", pattern = "ypred", recursive = T, full.names = T)
for(i in 1:length(files_to_c)){
res = read.table(files_to_c[[i]],header = T, sep = " ", skip = 0)
if(unique(res$cenario) == "Cenario_9"){
res = res %>% mutate(concat_coord = concat_cen9)
write.table(res, file = files_to_c[[i]] )
}
}
files_to_viz = list.files("../../results/", pattern = "ypred", recursive = T, full.names = T)
res =list()
for(i in 1:length(files_to_viz)){
res[[i]] = read.table(files_to_viz[[i]],header = T, sep = " ", skip = 0) %>%
mutate_if(is.factor, as.character)
}
results = do.call(bind_rows, res) %>% mutate(erro = ypred - yobs)
res1 = results %>% group_by(tecnica,target,cenario, hmlook_back) %>% summarise(mae = mean(abs(erro)))
res1 %>% filter(target == "temp") %>%
ggplot(aes(x = hmlook_back, y = mae, col = cenario)) + geom_line()+
facet_wrap(.~tecnica)
files_to_viz = list.files("../../results/", pattern = "ypred", recursive = T, full.names = T)
res =list()
for(i in 1:length(files_to_viz)){
res[[i]] = read.table(files_to_viz[[i]],header = T, sep = " ", skip = 0) %>%
mutate_if(is.factor, as.character)
}
results = do.call(bind_rows, res) %>% mutate(erro = ypred - yobs) %>%
mutate(abs_error = abs(erro))
# Plotting MAE progress over Scenarios -----------------------------------
res1 = results %>% group_by(tecnica,target,cenario, hmlook_back) %>%
summarise(mae = mean(abs_error))
res1 %>% filter(target == "temp") %>%
ggplot(aes(x = hmlook_back, y = mae, col = cenario)) + geom_line()+
facet_wrap(.~tecnica)
head(res1)
head(results)
results %>% filter(target == "temp") %>%
ggplot(aes(x = data, y = yobs, colour = concat_coord)) + geom_line() +
facet_wrap(~cenario, ncol = 2, scales = "free") + xlab('Timestamp') + ylab('Temperatura (Â°C)') +
scale_color_manual(labels = c("Real", "Predito"),values=c(rgb(1,0,0), rgb(0,0,1,0.7))) +
#facet_grid(tecnica~cenario, scales = "free") +
theme_bw() + theme(text = element_text(size = 7)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
theme(axis.text.x = element_text(size = 6))+
theme(axis.text.y = element_text(size=6))
results %>% filter(target == "temp") %>%
ggplot(aes(x = data, y = yobs, colour = concat_coord)) + geom_line() +
facet_wrap(~cenario, ncol = 2, scales = "free")
results %>% filter(target == "temp") %>%
ggplot(aes(x = hora, y = yobs, colour = concat_coord)) + geom_line()
results %>% filter(target == "temp", concat_coord == "-1.6-6.9-1.2") %>%
ggplot(aes(x = hora, y = yobs)) + geom_line()
res2 = results %>% filter(target == "temp", concat_coord == "-1.6-6.9-1.2") %>%
mutate(timestamp = seq(1:count))
head(results)
res2 = results %>% filter(target == "temp", concat_coord == "-1.6-6.9-1.2") %>%
mutate(timestamp = seq(1:length(yobs)))
head(res2)
res2 = results %>% filter(target == "temp", concat_coord == "-1.6-6.9-1.2") %>%
arrange(data,hora) %>%
mutate(timestamp = seq(1:length(yobs)))
res2 %>% ggplot(aes(x = timestamp, y = yobs)) + geom_line()
head(res2)
res2 = results %>%
filter(target == "temp", concat_coord == "-1.6-6.9-1.2", hmlook_back == 1) %>%
arrange(data,hora) %>%
mutate(timestamp = seq(1:length(yobs)))
res2 %>% ggplot(aes(x = timestamp, y = yobs)) + geom_line()
head(res2)
res2 = results %>%
filter(target == "temp", concat_coord == "-1.6-6.9-1.2", hmlook_back == 1) %>%
arrange(data,hora) %>%
mutate(timestamp = seq(1:length(yobs)))
res2 %>% ggplot(aes(x = timestamp, y = yobs)) + geom_line() +
facet_wrap(~cenario, ncol = 2, scales = "free")
res2 = results %>%
filter(target == "temp", concat_coord == "-1.6-6.9-1.2",
hmlook_back == 1, tecnica == "brt") %>%
arrange(data,hora) %>%
mutate(timestamp = seq(1:length(yobs)))
res2 %>% ggplot(aes(x = timestamp, y = yobs)) + geom_line() +
facet_wrap(~cenario, ncol = 2, scales = "free")
res2
res2 = results %>%
filter(target == "temp", concat_coord == "-1.6-6.9-1.2",
hmlook_back == 1, tecnica == "brt") %>%
arrange(data,hora) %>%
mutate(timestamp = seq(1:length(yobs)))
res2 %>% ggplot(aes(x = timestamp, y = yobs)) + geom_line() +
facet_wrap(~cenario, ncol = 2, scales = "free")
res2 = results %>%
filter(target == "temp", #concat_coord == "-1.6-6.9-1.2",
hmlook_back == 1, tecnica == "brt") %>%
arrange(data,hora) %>% group_by(concat_coord) %>%
mutate(timestamp = seq(1:length(yobs)))
head(res2)
res2 %>% ggplot(aes(x = timestamp, y = yobs)) + geom_line() +
facet_wrap(~cenario, ncol = 2, scales = "free")
?gather
res2 = results %>%
filter(target == "temp", #concat_coord == "-1.6-6.9-1.2",
hmlook_back == 1, tecnica == "brt") %>%
arrange(data,hora) %>% group_by(concat_coord) %>%
mutate(timestamp = seq(1:length(yobs))) %>% as.data.frame()
head(res2)
res2 = res2 %>% gather(tipo_medida, medida, c(yobs,ypred))
head(res2)
res2 = results %>%
filter(target == "temp", #concat_coord == "-1.6-6.9-1.2",
hmlook_back == 1, tecnica == "brt") %>%
arrange(data,hora) %>% group_by(concat_coord) %>%
mutate(timestamp = seq(1:length(yobs))) %>% as.data.frame()
res2 = res2 %>% gather(tipo_medida, medida, c(yobs,ypred))
res2 %>% ggplot(aes(x = timestamp, y = medida, col = tipo_medida)) + geom_line() +
facet_wrap(~cenario, ncol = 2, scales = "free")
res2 = results %>%
filter(target == "temp",
hmlook_back == 1, tecnica == "brt") %>%
arrange(data,hora) %>% group_by(concat_coord) %>%
mutate(timestamp = seq(1:length(yobs))) %>%
gather(tipo_medida, medida, c(yobs,ypred)) %>%
as.data.frame()
res2 %>% ggplot(aes(x = timestamp, y = medida, col = tipo_medida)) + geom_line() +
facet_wrap(~cenario, ncol = 2, scales = "free")
files_to_viz = list.files("../../results/", pattern = "ypred", recursive = T, full.names = T)
res =list()
for(i in 1:length(files_to_viz)){
res[[i]] = read.table(files_to_viz[[i]],header = T, sep = " ", skip = 0) %>%
mutate_if(is.factor, as.character)
}
results = do.call(bind_rows, res) %>% mutate(erro = ypred - yobs) %>%
mutate(abs_error = abs(erro))
# Plotting MAE progress over Scenarios -----------------------------------
res1 = results %>% group_by(tecnica,target,cenario, hmlook_back) %>%
summarise(mae = mean(abs_error))
res1 %>% filter(target == "temp") %>%
ggplot(aes(x = hmlook_back, y = mae, col = cenario)) + geom_line()+
facet_wrap(.~tecnica, scales  = "free")
res2 = results %>%
filter(target == "temp",
hmlook_back == 1, tecnica == "brt") %>%
arrange(data,hora) %>% group_by(concat_coord) %>%
mutate(timestamp = seq(1:length(yobs))) %>%
gather(tipo_medida, medida, c(yobs,ypred)) %>%
as.data.frame()
res2 %>% ggplot(aes(x = timestamp, y = medida, col = tipo_medida)) + geom_line() +
facet_wrap(~cenario, ncol = 2, scales = "free") + xlab('Timestamp') +
ylab('Temperatura (Â°C)') +
scale_color_manual(labels = c("Real", "Predito"),values=c(rgb(1,0,0), rgb(0,0,1,0.7))) +
theme_bw() + theme(text = element_text(size = 7)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
theme(axis.text.x = element_text(size = 6))+
theme(axis.text.y = element_text(size=6))+
theme(axis.title = element_text(size=12))+
theme(legend.text=element_text(size=10))+
theme(legend.title = element_text(size = 10))+
theme(strip.text = element_text(size = 10))
files_to_viz = list.files("../../results/", pattern = "ypred", recursive = T, full.names = T)
res =list()
for(i in 1:length(files_to_viz)){
res[[i]] = read.table(files_to_viz[[i]],header = T, sep = " ", skip = 0) %>%
mutate_if(is.factor, as.character)
}
results = do.call(bind_rows, res) %>% mutate(erro = ypred - yobs) %>%
mutate(abs_error = abs(erro))
# Plotting MAE progress over Scenarios -----------------------------------
res1 = results %>% group_by(tecnica,target,cenario, hmlook_back) %>%
summarise(mae = mean(abs_error))
res1 %>% filter(target == "temp") %>%
ggplot(aes(x = hmlook_back, y = mae, col = cenario)) + geom_line()+
facet_wrap(.~tecnica, scales  = "free")
res1
res1 = results %>% group_by(tecnica,target,cenario, hmlook_back) %>%
summarise(mae = mean(abs_error)) %>% as.data.frame()
res1
res1 = results %>% group_by(tecnica,target,cenario, hmlook_back) %>%
summarise(mae = mean(abs_error)) %>% as.data.frame()
res1 %>% filter(target == "ur") %>%
ggplot(aes(x = hmlook_back, y = mae, col = cenario)) + geom_line()+
facet_wrap(.~tecnica, scales  = "free")
res1 = results %>% group_by(tecnica,target,cenario, hmlook_back) %>%
summarise(mae = mean(abs_error)) %>% as.data.frame()
res1 %>% filter(target == "temp") %>%
ggplot(aes(x = hmlook_back, y = mae, col = cenario)) + geom_line()+
facet_wrap(.~tecnica, scales  = "free")
files_tbmodel = list.files('../../data/',
full.names = T,
pattern = ".RData")
dat = get(load(files_tbmodel[[4]]))
head(dat)
test_lines = which(dat$data %in% unique(dat$data)[8:10])
ver = dat[test_lines,] %>% arrange(data,hora)
head(ver)
files_to_c = list.files("../../results/svm", pattern = "ypred", recursive = T, full.names = T)
i = 1
res = read.table(files_to_c[[i]],header = T, sep = " ", skip = 0)
head(res)
i = 2
i = 4
res = read.table(files_to_c[[i]],header = T, sep = " ", skip = 0)
head(res)
i = 8
res = read.table(files_to_c[[i]],header = T, sep = " ", skip = 0)
head(res)
i = 12
res = read.table(files_to_c[[i]],header = T, sep = " ", skip = 0)
head(res)
head(ver)
head(ver$yobs)
head(ver$temp)
head(res)
files_tbmodel = list.files('../../data/',
full.names = T,
pattern = ".RData")
dat = get(load(files_tbmodel[[4]]))
test_lines = which(dat$data %in% unique(dat$data)[8:10])
ver = dat[test_lines,] %>% arrange(data,hora)
concat_cen9 = ver$concat_coord
files_to_c = list.files("../../results/svm", pattern = "ypred", recursive = T, full.names = T)
for(i in 1:length(files_to_c)){
res = read.table(files_to_c[[i]],header = T, sep = " ", skip = 0)
if(unique(res$cenario) == "Cenario_9"){
res = res %>% mutate(concat_coord = concat_cen9)
write.table(res, file = files_to_c[[i]] )
}
}
files_tbmodel = list.files('../../data/',
full.names = T,
pattern = ".RData")
dat = get(load(files_tbmodel[[3]]))
test_lines = which(dat$data %in% unique(dat$data)[8:10])
ver = dat[test_lines,] %>% arrange(data,hora)
head(ver)
concat_cen7 = ver$concat_coord
files_tbmodel = list.files('../../data/',
full.names = T,
pattern = ".RData")
dat = get(load(files_tbmodel[[3]]))
test_lines = which(dat$data %in% unique(dat$data)[8:10])
ver = dat[test_lines,] %>% arrange(data,hora)
concat_cen7 = ver$concat_coord
files_to_c = list.files("../../results/svm", pattern = "ypred", recursive = T, full.names = T)
for(i in 1:length(files_to_c)){
res = read.table(files_to_c[[i]],header = T, sep = " ", skip = 0)
if(unique(res$cenario) == "Cenario_7"){
res = res %>% mutate(concat_coord = concat_cen7)
write.table(res, file = files_to_c[[i]] )
}
}
files_tbmodel = list.files('../../data/',
full.names = T,
pattern = ".RData")
dat = get(load(files_tbmodel[[2]]))
test_lines = which(dat$data %in% unique(dat$data)[8:10])
ver = dat[test_lines,] %>% arrange(data,hora)
concat_cen5 = ver$concat_coord
head(dat$cenario)
files_tbmodel = list.files('../../data/',
full.names = T,
pattern = ".RData")
dat = get(load(files_tbmodel[[2]]))
test_lines = which(dat$data %in% unique(dat$data)[8:10])
ver = dat[test_lines,] %>% arrange(data,hora)
concat_cen5 = ver$concat_coord
files_to_c = list.files("../../results/svm", pattern = "ypred", recursive = T, full.names = T)
for(i in 1:length(files_to_c)){
res = read.table(files_to_c[[i]],header = T, sep = " ", skip = 0)
if(unique(res$cenario) == "Cenario_5"){
res = res %>% mutate(concat_coord = concat_cen5)
write.table(res, file = files_to_c[[i]] )
}
}
files_tbmodel = list.files('../../data/',
full.names = T,
pattern = ".RData")
dat = get(load(files_tbmodel[[1]]))
test_lines = which(dat$data %in% unique(dat$data)[8:10])
ver = dat[test_lines,] %>% arrange(data,hora)
concat_cen1 = ver$concat_coord
files_to_c = list.files("../../results/svm", pattern = "ypred", recursive = T, full.names = T)
for(i in 1:length(files_to_c)){
res = read.table(files_to_c[[i]],header = T, sep = " ", skip = 0)
if(unique(res$cenario) == "Cenario_1"){
res = res %>% mutate(concat_coord = concat_cen1)
write.table(res, file = files_to_c[[i]] )
}
}
files_to_viz = list.files("../../results/", pattern = "ypred", recursive = T, full.names = T)
res =list()
for(i in 1:length(files_to_viz)){
res[[i]] = read.table(files_to_viz[[i]],header = T, sep = " ", skip = 0) %>%
mutate_if(is.factor, as.character)
}
results = do.call(bind_rows, res) %>% mutate(erro = ypred - yobs) %>%
mutate(abs_error = abs(erro))
head(results)
